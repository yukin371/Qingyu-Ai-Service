# ==============================================
# Qingyu-AI-Service Configuration
# ==============================================
# 版本: 1.0.0
# 说明: 独立的 AI 服务，通过 gRPC 与 Go 后端通信
# ==============================================

# ------------ 服务配置 -------------
SERVICE_NAME=Qingyu-AI-Service
SERVICE_VERSION=1.0.0
SERVICE_PORT=8000
GRPC_PORT=50051
ENVIRONMENT=development
LOG_LEVEL=INFO

# ------------ LLM API Keys -------------
# OpenAI
OPENAI_API_KEY=sk-xxx
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4-turbo-preview

# Anthropic Claude
ANTHROPIC_API_KEY=sk-ant-xxx
ANTHROPIC_MODEL=claude-3-sonnet-20240229

# Google Gemini
GOOGLE_API_KEY=xxx
GEMINI_MODEL=gemini-2.0-flash-exp
GEMINI_TRANSPORT=rest

# 默认 LLM 配置
DEFAULT_LLM_PROVIDER=gemini
DEFAULT_LLM_MODEL=gemini-2.0-flash-exp

# ------------ Redis 配置 -------------
# 共享 Redis 实例，使用 key 前缀隔离
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_KEY_PREFIX=qingyu-ai:     # 独立前缀，与 Go 后端隔离
REDIS_MAX_CONNECTIONS=50

# ------------ MongoDB 配置 -------------
# 注意：当前使用 PostgreSQL，如果需要 MongoDB 请添加
MONGO_HOST=localhost
MONGO_PORT=27017
MONGO_DATABASE=qingyu_ai_service  # 独立 database

# ------------ PostgreSQL 配置 -------------
# 用于 Checkpointer 持久化
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=
POSTGRES_DATABASE=qingyu_ai_service  # 独立 database

# ------------ Milvus 配置 -------------
# 共享 Milvus 实例，使用 collection 前缀隔离
MILVUS_HOST=localhost
MILVUS_PORT=19530
MILVUS_COLLECTION_PREFIX=qingyu_ai_vectors_  # 独立前缀
MILVUS_COLLECTION_NAME=qingyu_knowledge

# ------------ Embedding 配置 -------------
EMBEDDING_PROVIDER=local
EMBEDDING_MODEL_NAME=BAAI/bge-large-zh-v1.5
EMBEDDING_MODEL_DEVICE=cuda
EMBEDDING_BATCH_SIZE=32
EMBEDDING_CACHE_ENABLED=true
EMBEDDING_CACHE_TTL=604800  # 7天

# OpenAI Embedding
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_EMBEDDING_BATCH_SIZE=100

# ------------ RAG 配置 -------------
RAG_TOP_K=5
RAG_RERANK_TOP_K=3
RAG_MAX_CONTEXT_TOKENS=2000
RAG_USE_RERANKER=false
RAG_USE_HYBRID_SEARCH=false

# Reranker
RERANKER_MODEL=BAAI/bge-reranker-large
RERANKER_BATCH_SIZE=32

# 混合检索
HYBRID_VECTOR_WEIGHT=0.7
HYBRID_BM25_WEIGHT=0.3
HYBRID_FUSION_METHOD=rrf

# ------------ 文本分割 -------------
TEXT_CHUNK_SIZE=500
TEXT_CHUNK_OVERLAP=50
TEXT_SPLITTER_TYPE=recursive

# ------------ 索引更新 -------------
INDEX_AUTO_UPDATE=true
INDEX_BATCH_SIZE=10
INDEX_BATCH_INTERVAL=60
INDEX_MAX_WORKERS=3
INDEX_RETRY_TIMES=3
INDEX_RETRY_DELAY=5

# ------------ Checkpointer -------------
ENABLE_CHECKPOINTER=true
CHECKPOINTER_BACKEND=postgres

# ------------ LangSmith 追踪 (可选) -------------
LANGCHAIN_TRACING_V2=false
LANGCHAIN_ENDPOINT=
LANGCHAIN_API_KEY=
LANGCHAIN_PROJECT=qingyu-ai-service

# ------------ Go Backend gRPC -------------
# 注意：这是 AI Service 连接到 Go Backend 的配置
# Go Backend 会通过 gRPC 调用 AI Service
GO_GRPC_HOST=localhost
GO_GRPC_PORT=50051
